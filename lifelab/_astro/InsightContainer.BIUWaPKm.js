import{i as Z}from"./lifecycle.C7LIllQC.js";import{o as lt}from"./index-client.CxbhdV-l.js";import{n as ct,u as d,b as tt,y as K,j as x,g as t,m as E,h as G,z as vt,f as j,c as p,s as k,I as X,t as W,a as M,r as u,p as et,D as st,e as dt,B as ht,C as ot}from"./template.BYV1JzE2.js";import{i as Y}from"./if.WMWJDOLq.js";import{p as q}from"./props.xJmC_mX4.js";import{s as P}from"./render.DGpk54Xg.js";import{e as Q,i as U}from"./each.C-V7QYcd.js";import{s as y}from"./attributes.7Dtqmd9f.js";/* empty css                       */import{s as nt}from"./class.BGF3wVPj.js";import{s as ft}from"./style.CNigzJNG.js";import{a as ut}from"./storage.mmsOLJq4.js";import{b as gt}from"./notebookSync.qY34yKPg.js";import"./attributes.Bu93Vllf.js";import"./config.BPkNxJtt.js";class rt{#t=new WeakMap;#e;#a;static entries=new WeakMap;constructor(a){this.#a=a}observe(a,e){var o=this.#t.get(a)||new Set;return o.add(e),this.#t.set(a,o),this.#s().observe(a,this.#a),()=>{var v=this.#t.get(a);v.delete(e),v.size===0&&(this.#t.delete(a),this.#e.unobserve(a))}}#s(){return this.#e??(this.#e=new ResizeObserver(a=>{for(var e of a){rt.entries.set(e.target,e);for(var o of this.#t.get(e.target)||[])o(e)}}))}}var mt=new rt({box:"border-box"});function yt(r,a,e){var o=mt.observe(r,()=>e(r[a]));ct(()=>(d(()=>e(r[a])),o))}var pt=X('<line stroke="#f0f0f0" stroke-width="1"></line>'),_t=X('<text text-anchor="end" font-size="11" fill="#666"> </text>'),bt=X('<path fill="none" stroke="#3b82f6" stroke-width="2"></path>'),xt=X("<circle></circle>"),wt=X('<text text-anchor="middle" font-size="11" fill="#666"> </text>'),Dt=j('<span class="today-marker svelte-11nj3n6"> </span>'),St=j(`<div class="line-graph svelte-11nj3n6"><svg class="svelte-11nj3n6"><rect fill="#fafafa" stroke="#e0e0e0"></rect><!><!><text text-anchor="middle" font-size="11" fill="#666">domains active</text><!><!><!><text text-anchor="middle" font-size="11" fill="#666">day of month</text></svg> <div class="graph-caption svelte-11nj3n6"><p class="svelte-11nj3n6">This graph shows daily domain engagement across the month.
      Higher points indicate more domains were active on that day. <!></p></div></div>`);function Mt(r,a){tt(a,!1);const e=E(),o=E(),v=E(),_=E(),w=E(),T=E(),A=E(),D=E();let m=q(a,"days",24,()=>[]),S=q(a,"dailySignals",24,()=>[]),I=q(a,"currentDay",8,null),n=E(800),z=200;const i={top:20,right:20,bottom:30,left:40};K(()=>t(n),()=>{x(e,t(n)-i.left-i.right)}),K(()=>{},()=>{x(o,z-i.top-i.bottom)}),K(()=>G(S()),()=>{x(v,Math.max(...S(),1))}),K(()=>(G(m()),t(e)),()=>{x(_,f=>(f-1)/Math.max(m().length-1,1)*t(e))}),K(()=>(t(o),t(v)),()=>{x(w,f=>t(o)-f/t(v)*t(o))}),K(()=>(G(S()),t(_),G(m()),t(w)),()=>{x(T,S().length>0?S().map((f,s)=>{const c=t(_)(m()[s]),V=t(w)(f);return s===0?`M ${c} ${V}`:`L ${c} ${V}`}).join(" "):"")}),K(()=>(G(m()),t(_),t(w),G(S()),G(I())),()=>{x(A,m().map((f,s)=>({day:f,x:t(_)(f),y:t(w)(S()[s]),signal:S()[s],isToday:f===I()})))}),K(()=>(t(v),t(w)),()=>{x(D,Array.from({length:5},(f,s)=>{const c=Math.round(t(v)/4*s);return{value:c,y:t(w)(c)}}).reverse())}),vt(),Z();var O=St(),l=p(O);y(l,"height",z);var b=p(l),N=k(b);Q(N,1,()=>t(D),U,(f,s)=>{var c=pt();W(()=>{y(c,"x1",d(()=>i.left)),y(c,"y1",(t(s),d(()=>i.top+t(s).y))),y(c,"x2",(t(e),d(()=>i.left+t(e)))),y(c,"y2",(t(s),d(()=>i.top+t(s).y)))}),M(f,c)});var g=k(N);Q(g,1,()=>t(D),U,(f,s)=>{var c=_t(),V=p(c,!0);u(c),W(()=>{y(c,"x",d(()=>i.left-8)),y(c,"y",(t(s),d(()=>i.top+t(s).y+4))),P(V,(t(s),d(()=>t(s).value)))}),M(f,c)});var h=k(g);y(h,"x",12);var H=k(h);{var $=f=>{var s=bt();W(()=>{y(s,"d",t(T)),y(s,"transform",`translate(${d(()=>i.left)??""}, ${d(()=>i.top)??""})`)}),M(f,s)};Y(H,f=>{t(T)&&f($)})}var L=k(H);Q(L,1,()=>t(A),U,(f,s)=>{var c=xt();W(()=>{y(c,"cx",(t(s),d(()=>i.left+t(s).x))),y(c,"cy",(t(s),d(()=>i.top+t(s).y))),y(c,"r",(t(s),d(()=>t(s).isToday?5:3))),y(c,"fill",(t(s),d(()=>t(s).isToday?"#ef4444":t(s).signal>0?"#3b82f6":"#d1d5db"))),y(c,"stroke",(t(s),d(()=>t(s).isToday?"#991b1b":"none"))),y(c,"stroke-width",(t(s),d(()=>t(s).isToday?2:0)))}),M(f,c)});var C=k(L);Q(C,1,()=>(G(m()),d(()=>m().filter((f,s)=>s%5===0||s===m().length-1))),U,(f,s)=>{var c=wt(),V=p(c,!0);u(c),W(it=>{y(c,"x",it),y(c,"y",d(()=>z-i.bottom+20)),P(V,t(s))},[()=>(t(_),t(s),d(()=>i.left+t(_)(t(s))))]),M(f,c)});var R=k(C);y(R,"y",z-5),u(l);var B=k(l,2),F=p(B),J=k(p(F));{var at=f=>{var s=Dt(),c=p(s);u(s),W(()=>P(c,`Red dot marks today (day ${I()??""}).`)),M(f,s)};Y(J,f=>{I()&&f(at)})}u(F),u(B),u(O),W(()=>{y(l,"width",t(n)),y(b,"x",d(()=>i.left)),y(b,"y",d(()=>i.top)),y(b,"width",t(e)),y(b,"height",t(o)),y(h,"y",(t(o),d(()=>i.top+t(o)/2))),y(h,"transform",`rotate(-90, 12, ${t(o),d(()=>i.top+t(o)/2)??""})`),y(R,"x",(t(e),d(()=>i.left+t(e)/2)))}),yt(O,"clientWidth",f=>x(n,f)),M(r,O),et()}var At=j('<div class="today-marker svelte-v05o5c">•</div>'),zt=j('<th><div class="day-label svelte-v05o5c"> </div> <!></th>'),kt=j("<td></td>"),Tt=j('<tr class="svelte-v05o5c"><td class="domain-cell svelte-v05o5c"><div class="domain-name svelte-v05o5c"> </div></td><!></tr>'),It=j(`<div class="heatmap-container svelte-v05o5c"><div class="heatmap-scroll svelte-v05o5c"><table class="heatmap svelte-v05o5c"><thead class="svelte-v05o5c"><tr class="svelte-v05o5c"><th class="domain-header-label svelte-v05o5c">Domain</th><!></tr></thead><tbody class="svelte-v05o5c"></tbody></table></div> <div class="heatmap-legend svelte-v05o5c"><div class="legend-title svelte-v05o5c">Reading the heatmap:</div> <div class="legend-items svelte-v05o5c"><div class="legend-item svelte-v05o5c"><div class="legend-color svelte-v05o5c" style="background-color: #ffffff; border: 1px solid #e5e7eb;"></div> <span class="svelte-v05o5c">No activity</span></div> <div class="legend-item svelte-v05o5c"><div class="legend-color svelte-v05o5c" style="background-color: #bfdbfe;"></div> <span class="svelte-v05o5c">Active</span></div></div> <p class="legend-note svelte-v05o5c">Each cell shows whether a domain had activity on that day.
      This is not a measure of success—only presence.</p></div></div>`);function Nt(r,a){tt(a,!1);let e=q(a,"days",24,()=>[]),o=q(a,"domains",24,()=>[]),v=q(a,"heatmapMatrix",24,()=>[]),_=q(a,"currentDay",8,null);function w(l){return l.charAt(0).toUpperCase()+l.slice(1)}function T(l){return l===0?"#ffffff":l===1?"#bfdbfe":l===2?"#3b82f6":"#ffffff"}function A(l){return l===_()}function D(l,b){return v()[b]?.[l]||0}Z();var m=It(),S=p(m),I=p(S),n=p(I),z=p(n),i=k(p(z));Q(i,1,e,U,(l,b)=>{var N=zt();let g;var h=p(N),H=p(h,!0);u(h);var $=k(h,2);{var L=C=>{var R=At();M(C,R)};Y($,C=>{t(b),d(()=>A(t(b)))&&C(L)})}u(N),W(C=>{g=nt(N,1,"day-header svelte-v05o5c",null,g,C),P(H,t(b))},[()=>({today:A(t(b))})]),M(l,N)}),u(z),u(n);var O=k(n);Q(O,5,o,U,(l,b,N)=>{var g=Tt(),h=p(g),H=p(h),$=p(H,!0);u(H),u(h);var L=k(h);Q(L,1,e,U,(C,R,B)=>{var F=kt();let J;W((at,f,s,c)=>{J=nt(F,1,"heat-cell svelte-v05o5c",null,J,at),ft(F,`background-color: ${f??""}`),y(F,"title",`${s??""} on day ${t(R)??""}: ${c??""}`)},[()=>({"today-col":A(t(R))}),()=>d(()=>T(D(N,B))),()=>(t(b),d(()=>w(t(b)))),()=>d(()=>D(N,B)>0?"active":"inactive")]),M(C,F)}),u(g),W(C=>P($,C),[()=>(t(b),d(()=>w(t(b))))]),M(l,g)}),u(O),u(I),u(S),st(2),u(m),M(r,m),et()}var $t=j('<p class="month-summary svelte-1uct5iz"> </p>'),Ct=j('<li class="observation-item svelte-1uct5iz"><span class="obs-icon svelte-1uct5iz"> </span> <span class="obs-text svelte-1uct5iz"> </span></li>'),Et=j('<ul class="observation-list svelte-1uct5iz"></ul>'),Ht=j('<p class="no-observations svelte-1uct5iz">No notable patterns detected this month.</p>'),jt=j(`<div class="observations-content svelte-1uct5iz"><!> <!> <p class="disclaimer svelte-1uct5iz">These observations are descriptive only—they describe what happened,
        not whether it was good or bad.</p></div>`),Ot=j('<div class="insight-observations svelte-1uct5iz"><button class="section-toggle svelte-1uct5iz"><span class="toggle-icon svelte-1uct5iz"> </span> <h3 class="section-title svelte-1uct5iz">Pattern Observations</h3></button> <!></div>');function Lt(r,a){tt(a,!1);let e=q(a,"observations",24,()=>[]),o=q(a,"monthSummary",8,""),v=E(!0);function _(){x(v,!t(v))}function w(n){switch(n){case"cluster":return"▪";case"gap":return"○";case"consistency":return"~";case"participation":return"●";default:return"•"}}Z();var T=Ot(),A=p(T),D=p(A),m=p(D,!0);u(D),st(2),u(A);var S=k(A,2);{var I=n=>{var z=jt(),i=p(z);{var O=g=>{var h=$t(),H=p(h,!0);u(h),W(()=>P(H,o())),M(g,h)};Y(i,g=>{o()&&g(O)})}var l=k(i,2);{var b=g=>{var h=Et();Q(h,5,e,U,(H,$)=>{var L=Ct(),C=p(L),R=p(C,!0);u(C);var B=k(C,2),F=p(B,!0);u(B),u(L),W(J=>{P(R,J),P(F,(t($),d(()=>t($).text)))},[()=>(t($),d(()=>w(t($).type)))]),M(H,L)}),u(h),M(g,h)},N=g=>{var h=Ht();M(g,h)};Y(l,g=>{G(e()),d(()=>e().length>0)?g(b):g(N,!1)})}st(2),u(z),M(n,z)};Y(S,n=>{t(v)&&n(I)})}u(T),W(()=>P(m,t(v)?"▼":"▶")),dt("click",A,_),M(r,T),et()}function Rt(r,a,e){const o=`${r}-${String(a).padStart(2,"0")}`,v=new Date(r,a,0).getDate(),_=Array.from({length:v},(D,m)=>m+1),w={},T={},A=new Set;return _.forEach(D=>{w[D]={},T[D]=0}),e.forEach(D=>{const m=new Date(D.date),S=m.getDate();if(m.getFullYear()!==r||m.getMonth()+1!==a)return;const I=D.domains||[];I.forEach(n=>{A.add(n),w[S][n]=1}),T[S]=I.length}),{monthId:o,year:r,month:a,days:_,domains:Array.from(A).sort(),dailyDomainMap:w,dailyAggregateSignal:T}}function Wt(r){return r.days.map(a=>r.dailyAggregateSignal[a]||0)}function qt(r){return r.days.map(a=>r.domains.map(e=>r.dailyDomainMap[a]?.[e]||0))}function Ft(r){const a=[],e=r.days.map(n=>r.dailyAggregateSignal[n]),o=e.filter(n=>n>0).length,v=r.days.length;if(o===0)return[{text:"No domain activity recorded this month.",type:"participation"}];const _=Gt(e);if(_.length>0){const n=_.reduce((O,l)=>l.length>O.length?l:O),z=n.start+1,i=n.end+1;n.length>=5&&a.push({text:`Activity clustered between days ${z}-${i} with ${n.length} consecutive active days.`,type:"cluster"})}const w=Pt(e);if(w.length>0){const n=w.reduce((z,i)=>i.length>z.length?i:z);if(n.length>=5){const z=n.start+1,i=n.end+1;a.push({text:`Quiet period from days ${z}-${i} with no recorded activity.`,type:"gap"})}}const T=e.slice(0,Math.floor(v/2)),A=e.slice(Math.floor(v/2)),D=T.filter(n=>n>0).length,m=A.filter(n=>n>0).length;Math.abs(D-m)>=5&&(D>m?a.push({text:"Activity was more frequent in the first half of the month.",type:"consistency"}):a.push({text:"Activity increased in the second half of the month.",type:"consistency"}));const I=r.domains.length;return I>=4?a.push({text:`${I} different domains were active this month.`,type:"participation"}):I===1&&a.push({text:`Focus was concentrated in a single domain: ${r.domains[0]}.`,type:"participation"}),a.slice(0,3)}function Gt(r){const a=[];let e=-1;return r.forEach((o,v)=>{o>0?e===-1&&(e=v):e!==-1&&(a.push({start:e,end:v-1,length:v-e}),e=-1)}),e!==-1&&a.push({start:e,end:r.length-1,length:r.length-e}),a}function Pt(r){const a=[];let e=-1;return r.forEach((o,v)=>{o===0?e===-1&&(e=v):e!==-1&&(a.push({start:e,end:v-1,length:v-e}),e=-1)}),e!==-1&&a.push({start:e,end:r.length-1,length:r.length-e}),a}function Bt(r){const e=r.days.map(_=>r.dailyAggregateSignal[_]).filter(_=>_>0).length,o=r.days.length,v=r.domains.length;return e===0?"No activity recorded this month.":`${e} of ${o} days had activity across ${v} domain${v!==1?"s":""}.`}var Kt=j('<div class="loading svelte-1wmtx9x"><p>Loading insights...</p></div>'),Qt=j('<section class="insight-section svelte-1wmtx9x"><h2 class="insight-title svelte-1wmtx9x">Monthly Activity Flow</h2> <!></section> <section class="insight-section svelte-1wmtx9x"><h2 class="insight-title svelte-1wmtx9x">Domain Distribution</h2> <!></section> <section class="insight-section svelte-1wmtx9x"><!></section>',1);function ce(r,a){tt(a,!1);let e=q(a,"year",8),o=q(a,"month",8),v=q(a,"currentDay",8),_=E([]),w=E([]),T=E([]),A=E([]),D=E([]),m=E(""),S=E(!0);lt(()=>{I()});function I(){gt(e(),o());const l=ut(e(),o());if(!l){const h=new Date(e(),o(),0).getDate();x(_,Array.from({length:h},(H,$)=>$+1)),x(w,[]),x(T,Array(h).fill(0)),x(A,Array(h).fill([])),x(D,[]),x(m,"No activity recorded this month."),x(S,!1);return}const b=new Date(e(),o(),0).getDate(),N=Array.from({length:b},(h,H)=>{const $=H+1,L=String($),C=new Date(e(),o()-1,$).toISOString().split("T")[0],R=l.days[L]||{};return{date:C,domains:R.domains||[],intent:R.intent,quality:R.quality,outcome:R.outcome}}),g=Rt(e(),o(),N);x(_,g.days),x(w,g.domains),x(T,Wt(g)),x(A,qt(g)),x(D,Ft(g)),x(m,Bt(g)),x(S,!1)}Z();var n=ht(),z=ot(n);{var i=l=>{var b=Kt();M(l,b)},O=l=>{var b=Qt(),N=ot(b),g=k(p(N),2);Mt(g,{get days(){return t(_)},get dailySignals(){return t(T)},get currentDay(){return v()}}),u(N);var h=k(N,2),H=k(p(h),2);Nt(H,{get days(){return t(_)},get domains(){return t(w)},get heatmapMatrix(){return t(A)},get currentDay(){return v()}}),u(h);var $=k(h,2),L=p($);Lt(L,{get observations(){return t(D)},get monthSummary(){return t(m)}}),u($),M(l,b)};Y(z,l=>{t(S)?l(i):l(O,!1)})}M(r,n),et()}export{ce as default};
