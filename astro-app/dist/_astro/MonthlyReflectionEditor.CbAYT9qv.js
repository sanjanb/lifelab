import{i as K}from"./lifecycle.BvhUjWVf.js";import{o as Q}from"./index-client.DcO2RGGq.js";import{m as s,y as h,z as U,f as G,t as P,g as e,a as A,p as V,b as Y,j as o,h as Z,s as c,c as r,r as n,d as $}from"./template.BZWBxZBu.js";import{s as w}from"./render.DvhAf7JS.js";import{i as ee}from"./if.fQTVglCE.js";import{s as te}from"./attributes.Bx7jKKNJ.js";import{s as T}from"./class.DwUQaaTL.js";import{b as ae}from"./input.CG_-woNV.js";import{p as S}from"./props.C-M9dvSZ.js";import{a as C,b as oe}from"./storage.mmsOLJq4.js";/* empty css                          */import"./attributes.Bu93Vllf.js";import"./config.BPkNxJtt.js";var se=G("<span> </span>"),re=G('<div class="reflection-editor svelte-ovqiz1"><div class="editor-header svelte-ovqiz1"><h3 class="svelte-ovqiz1">Monthly Reflection</h3> <!></div> <div class="starter-prompt svelte-ovqiz1"><span class="prompt-label svelte-ovqiz1">Starter:</span> <span class="prompt-text svelte-ovqiz1"> </span></div> <textarea placeholder="Complete the thought above, or write your own single sentence reflection." rows="3"></textarea> <div class="editor-footer svelte-ovqiz1"><span class="hint-text svelte-ovqiz1">One sentence to anchor the month</span> <span> </span></div></div>');function be(H,f){Y(f,!1);const u=s(),d=s(),_=s();let k=S(f,"year",8),R=S(f,"month",8),g=S(f,"initialReflection",8,""),a=s(g()),i=s(!1),m=s(null),p=s(null);const b=200,x=["This month felt like...","The most meaningful part was...","I learned that...","What stood out was...","This month reminded me that..."];let N=s(x[0]);Q(()=>{const t=C(k(),R());t&&t.reflection&&o(a,t.reflection),o(N,x[Math.floor(Math.random()*x.length)])});async function I(){if(!e(i)){o(i,!0);try{const t=C(k(),R());if(!t){console.error("Notebook not found");return}t.reflection=e(a),oe(t)&&o(m,new Date)}catch(t){console.error("Error saving reflection:",t)}finally{o(i,!1)}}}h(()=>(e(a),Z(g()),e(p)),()=>{e(a)!==g()&&(e(p)&&clearTimeout(e(p)),o(p,setTimeout(()=>{I()},1e3)))}),h(()=>e(a),()=>{o(u,b-e(a).length)}),h(()=>e(a),()=>{o(d,e(a).length>b)}),h(()=>(e(i),e(m)),()=>{o(_,(()=>{if(e(i))return"Saving...";if(e(m)){const t=Math.floor((Date.now()-e(m).getTime())/1e3);return t<5?"Saved just now":t<60?`Saved ${t}s ago`:`Saved ${Math.floor(t/60)}m ago`}return""})())}),U(),K();var y=re(),z=r(y),W=c(r(z),2);{var X=t=>{var l=se();let O;var J=r(l,!0);n(l),P(()=>{O=T(l,1,"save-status svelte-ovqiz1",null,O,{saving:e(i)}),w(J,e(_))}),A(t,l)};ee(W,t=>{e(_)&&t(X)})}n(z);var q=c(z,2),E=c(r(q),2),B=r(E,!0);n(E),n(q);var v=c(q,2);$(v);let j;te(v,"maxlength",b);var D=c(v,2),M=c(r(D),2);let L;var F=r(M);n(M),n(D),n(y),P(()=>{w(B,e(N)),j=T(v,1,"reflection-textarea svelte-ovqiz1",null,j,{"over-limit":e(d)}),L=T(M,1,"char-count svelte-ovqiz1",null,L,{warning:e(u)<20,error:e(d)}),w(F,`${e(u)??""} characters remaining`)}),ae(v,()=>e(a),t=>o(a,t)),A(H,y),V()}export{be as default};
