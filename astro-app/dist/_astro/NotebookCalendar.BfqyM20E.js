import{i as ae}from"./lifecycle.BvhUjWVf.js";import{l as we,k as le,n as ke,o as Ne,q as pe,v as Se,w as xe,x as Ce,f as E,t as z,a as x,p as Y,b as Z,j as _,g as e,m as L,c as b,r as y,s as T,u as h,e as ee,y as H,h as J,z as ue,A as re,B as Ee,C as qe}from"./template.BZWBxZBu.js";import{i as K}from"./if.fQTVglCE.js";import{p as N}from"./props.C-M9dvSZ.js";import{c as Me,o as de}from"./index-client.DcO2RGGq.js";import{s as W}from"./render.DvhAf7JS.js";import{e as G,i as j}from"./each.CNRnYATT.js";import{s as oe}from"./attributes.Bx7jKKNJ.js";import{s as ye}from"./class.DwUQaaTL.js";import{s as ie}from"./style.w03N4KMi.js";import{g as me,b as Fe}from"./notebookSync.qY34yKPg.js";import{a as ve,b as Te}from"./storage.mmsOLJq4.js";/* empty css                          */import{g as Le}from"./config.BPkNxJtt.js";import"./attributes.Bu93Vllf.js";function fe(r,t,c=!1){if(r.multiple){if(t==null)return;if(!pe(t))return Se();for(var d of r.options)d.selected=t.includes(X(d));return}for(d of r.options){var p=X(d);if(xe(p,t)){d.selected=!0;return}}(!c||t!==void 0)&&(r.selectedIndex=-1)}function Ae(r){var t=new MutationObserver(()=>{fe(r,r.__value)});t.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ne(()=>{t.disconnect()})}function se(r,t,c=t){var d=new WeakSet,p=!0;we(r,"change",v=>{var s=v?"[selected]":":checked",o;if(r.multiple)o=[].map.call(r.querySelectorAll(s),X);else{var f=r.querySelector(s)??r.querySelector("option:not([disabled])");o=f&&X(f)}c(o),le!==null&&d.add(le)}),ke(()=>{var v=t();if(r===document.activeElement){var s=Ce??le;if(d.has(s))return}if(fe(r,v,p),p&&v===void 0){var o=r.querySelector(":checked");o!==null&&(v=X(o),c(v))}r.__value=v,p=!1}),Ae(r)}function X(r){return"__value"in r?r.__value:r.value}var ze=E('<span class="domain-dot svelte-vv5uaa"></span>'),Ie=E('<span class="domain-dot more svelte-vv5uaa"> </span>'),Oe=E('<div class="domain-dots svelte-vv5uaa"><!> <!></div>'),Ue=E('<div class="today-indicator svelte-vv5uaa">•</div>'),Pe=E('<button><div class="day-number svelte-vv5uaa"> </div> <!> <!></button>'),We=E('<div class="calendar-week svelte-vv5uaa"></div>'),Qe=E('<div class="calendar-container svelte-vv5uaa"><div class="calendar-header svelte-vv5uaa"><h3 class="svelte-vv5uaa"> </h3></div> <div class="calendar-grid svelte-vv5uaa"><div class="weekday-headers svelte-vv5uaa"><div class="weekday-header svelte-vv5uaa">Sun</div> <div class="weekday-header svelte-vv5uaa">Mon</div> <div class="weekday-header svelte-vv5uaa">Tue</div> <div class="weekday-header svelte-vv5uaa">Wed</div> <div class="weekday-header svelte-vv5uaa">Thu</div> <div class="weekday-header svelte-vv5uaa">Fri</div> <div class="weekday-header svelte-vv5uaa">Sat</div></div> <!></div></div>');function Be(r,t){Z(t,!1);let c=N(t,"year",8),d=N(t,"month",8),p=N(t,"currentDay",8,null),v=N(t,"selectedDay",12,null);const s=Me();let o=L([]),f=L("");de(()=>(w(),window.addEventListener("entryAdded",w),()=>{window.removeEventListener("entryAdded",w)}));function w(){const a=new Date(c(),d()-1,1),k=new Date(c(),d(),0).getDate();_(f,a.toLocaleDateString("en-US",{month:"long",year:"numeric"}));const S=a.getDay(),n=[];for(let u=0;u<S;u++){const q=new Date(c(),d()-1,-S+u+1);n.push({dayNumber:q.getDate(),dayName:q.toLocaleDateString("en-US",{weekday:"short"}),date:q,isToday:!1,isInMonth:!1,domains:[],quality:null})}for(let u=1;u<=k;u++){const q=new Date(c(),d()-1,u),te=p()===u,$=me(c(),d(),u)||[],ne=g(u);n.push({dayNumber:u,dayName:q.toLocaleDateString("en-US",{weekday:"short"}),date:q,isToday:te,isInMonth:!0,domains:$,quality:ne})}const F=7-n.length%7;if(F<7)for(let u=1;u<=F;u++){const q=new Date(c(),d(),u);n.push({dayNumber:q.getDate(),dayName:q.toLocaleDateString("en-US",{weekday:"short"}),date:q,isToday:!1,isInMonth:!1,domains:[],quality:null})}_(o,[]);for(let u=0;u<n.length;u+=7)e(o).push(n.slice(u,u+7))}function g(a){const l=ve(c(),d());if(!l)return null;const k=String(a);return l.days[k]?.quality||null}function O(a){return{habits:"#4CAF50",learning:"#2196F3",career:"#FF9800",health:"#E91E63"}[a]||"#9E9E9E"}function A(a){return a?a==="3"?"#10b981":a==="2"?"#f59e0b":a==="1"?"#6b7280":"#e5e7eb":"#e5e7eb"}function U(a){a.isInMonth&&(v(a.dayNumber),s("daySelected",{dayNumber:a.dayNumber}))}ae();var C=Qe(),M=b(C),m=b(M),D=b(m,!0);y(m),y(M);var I=T(M,2),i=T(b(I),2);G(i,1,()=>e(o),j,(a,l)=>{var k=We();G(k,5,()=>e(l),j,(S,n)=>{var F=Pe();let u;var q=b(F),te=b(q,!0);y(q);var $=T(q,2);{var ne=P=>{var Q=Oe(),ce=b(Q);G(ce,1,()=>(e(n),h(()=>e(n).domains.slice(0,4))),j,(R,B)=>{var V=ze();z(De=>{ie(V,`background-color: ${De??""}`),oe(V,"title",e(B))},[()=>(e(B),h(()=>O(e(B))))]),x(R,V)});var _e=T(ce,2);{var ge=R=>{var B=Ie(),V=b(B);y(B),z(()=>W(V,`+${e(n),h(()=>e(n).domains.length-4)??""}`)),x(R,B)};K(_e,R=>{e(n),h(()=>e(n).domains.length>4)&&R(ge)})}y(Q),x(P,Q)};K($,P=>{e(n),h(()=>e(n).isInMonth&&e(n).domains.length>0)&&P(ne)})}var he=T($,2);{var be=P=>{var Q=Ue();x(P,Q)};K(he,P=>{e(n),h(()=>e(n).isToday)&&P(be)})}y(F),z((P,Q)=>{u=ye(F,1,"calendar-day svelte-vv5uaa",null,u,{"in-month":e(n).isInMonth,"out-month":!e(n).isInMonth,today:e(n).isToday,selected:v()===e(n).dayNumber&&e(n).isInMonth}),ie(F,`border-color: ${P??""}`),F.disabled=(e(n),h(()=>!e(n).isInMonth)),oe(F,"title",Q),W(te,(e(n),h(()=>e(n).dayNumber)))},[()=>(e(n),h(()=>e(n).isInMonth?A(e(n).quality):"transparent")),()=>(e(n),e(f),h(()=>e(n).isInMonth?`${e(n).dayName}, ${e(f).split(" ")[0]} ${e(n).dayNumber}`:""))]),ee("click",F,()=>U(e(n))),x(S,F)}),y(k),x(a,k)}),y(I),y(C),z(()=>W(D,e(f))),x(r,C),Y()}var Ge=E("<option> </option>"),Ke=E("<option> </option>"),je=E("<option> </option>"),Re=E('<div class="daily-controls svelte-zhymxz"><select class="control-select intent-select svelte-zhymxz" title="Daily Intent"></select> <select class="control-select quality-select svelte-zhymxz" title="Day Quality"></select> <select class="control-select outcome-select svelte-zhymxz" title="Day Outcome"></select></div>');function Ve(r,t){Z(t,!1);let c=N(t,"year",8),d=N(t,"month",8),p=N(t,"dayNumber",8),v=N(t,"initialData",24,()=>({})),s=L(v().intent||""),o=L(v().quality||""),f=L(v().outcome||""),w=L(!1);const g=String(p()),O=[{value:"",label:"None"},{value:"flow",label:"Flow"},{value:"focus",label:"Focus"},{value:"ease",label:"Ease"}],A=[{value:"",label:"None"},{value:"3",label:"3 - Excellent"},{value:"2",label:"2 - Good"},{value:"1",label:"1 - Fair"}],U=[{value:"",label:"None"},{value:"win",label:"Win"},{value:"neutral",label:"Neutral"},{value:"loss",label:"Loss"}];de(()=>{Fe(c(),d());const i=ve(c(),d());if(i&&i.days[g]){const a=i.days[g];_(s,a.intent||""),_(o,a.quality||""),_(f,a.outcome||"")}});async function C(){if(!e(w)){_(w,!0);try{const i=ve(c(),d());if(!i){console.error("Notebook not found");return}if(!i.days[g]){console.error(`Day ${g} not found in notebook`);return}i.days[g]={...i.days[g],intent:e(s)||void 0,quality:e(o)||void 0,outcome:e(f)||void 0},Te(i)}catch(i){console.error("Error saving daily controls:",i)}finally{_(w,!1)}}}H(()=>(e(s),J(v()),e(o),e(f)),()=>{typeof window<"u"&&(e(s)!==v().intent||e(o)!==v().quality||e(f)!==v().outcome)&&C()}),ue(),ae();var M=Re(),m=b(M);z(()=>{e(s),re(()=>{e(w)})}),G(m,5,()=>O,j,(i,a)=>{var l=Ge(),k=b(l,!0);y(l);var S={};z(()=>{W(k,(e(a),h(()=>e(a).label))),S!==(S=(e(a),h(()=>e(a).value)))&&(l.value=(l.__value=(e(a),h(()=>e(a).value)))??"")}),x(i,l)}),y(m);var D=T(m,2);z(()=>{e(o),re(()=>{e(w)})}),G(D,5,()=>A,j,(i,a)=>{var l=Ke(),k=b(l,!0);y(l);var S={};z(()=>{W(k,(e(a),h(()=>e(a).label))),S!==(S=(e(a),h(()=>e(a).value)))&&(l.value=(l.__value=(e(a),h(()=>e(a).value)))??"")}),x(i,l)}),y(D);var I=T(D,2);z(()=>{e(f),re(()=>{e(w)})}),G(I,5,()=>U,j,(i,a)=>{var l=je(),k=b(l,!0);y(l);var S={};z(()=>{W(k,(e(a),h(()=>e(a).label))),S!==(S=(e(a),h(()=>e(a).value)))&&(l.value=(l.__value=(e(a),h(()=>e(a).value)))??"")}),x(i,l)}),y(I),y(M),z(()=>{m.disabled=e(w),D.disabled=e(w),I.disabled=e(w)}),se(m,()=>e(s),i=>_(s,i)),se(D,()=>e(o),i=>_(o,i)),se(I,()=>e(f),i=>_(f,i)),x(r,M),Y()}var He=E('<span class="no-activity svelte-1ulu2pn">-</span>'),Je=E('<span class="domain-badge svelte-1ulu2pn"> </span>'),Xe=E('<div class="domain-badges svelte-1ulu2pn"><!></div>');function Ye(r,t){Z(t,!1);let c=N(t,"year",8),d=N(t,"month",8),p=N(t,"dayNumber",8);const v=Le();let s=L([]),o=L(null);de(()=>(f(),window.addEventListener("entryAdded",f),()=>{window.removeEventListener("entryAdded",f)}));function f(){const m=me(c(),d(),p());_(s,m||[])}function w(m){return v.find(D=>D.id===m)}function g(m){const D=w(m);return D?D.displayName:m}function O(m){return{habits:"#4CAF50",learning:"#2196F3",career:"#FF9800",health:"#E91E63"}[m]||"#9E9E9E"}ae();var A=Xe(),U=b(A);{var C=m=>{var D=He();x(m,D)},M=m=>{var D=Ee(),I=qe(D);G(I,1,()=>e(s),i=>i,(i,a)=>{var l=Je(),k=b(l,!0);y(l),z((S,n,F)=>{ie(l,`background-color: ${S??""}`),oe(l,"title",`${n??""} - Day ${p()??""}`),W(k,F)},[()=>(e(a),h(()=>O(e(a)))),()=>(e(a),h(()=>g(e(a)))),()=>(e(a),h(()=>g(e(a)).substring(0,1)))]),ee("mouseenter",l,()=>_(o,e(a))),ee("mouseleave",l,()=>_(o,null)),x(i,l)}),x(m,D)};K(U,m=>{e(s),h(()=>e(s).length===0)?m(C):m(M,!1)})}y(A),x(r,A),Y()}var Ze=E('<span class="today-badge svelte-osrvy9">Today</span>'),$e=E('<div><div class="panel-header svelte-osrvy9"><div class="day-info svelte-osrvy9"><h3 class="svelte-osrvy9"> <!></h3> <p class="full-date svelte-osrvy9"> </p></div> <button class="close-btn svelte-osrvy9" title="Collapse">✕</button></div> <div class="panel-content svelte-osrvy9"><div class="controls-section svelte-osrvy9"><label class="section-label svelte-osrvy9">Day Settings</label> <!></div> <div class="domains-section svelte-osrvy9"><label class="section-label svelte-osrvy9">Active Domains</label> <!></div></div></div>');function ea(r,t){Z(t,!1);const c=L(),d=L(),p=L();let v=N(t,"year",8),s=N(t,"month",8),o=N(t,"dayNumber",8),f=N(t,"isToday",8,!1),w=N(t,"onClose",8,()=>{});H(()=>(J(v()),J(s()),J(o())),()=>{_(c,new Date(v(),s()-1,o()))}),H(()=>e(c),()=>{_(d,e(c).toLocaleDateString("en-US",{weekday:"long"}))}),H(()=>e(c),()=>{_(p,e(c).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}))}),ue(),ae();var g=$e();let O;var A=b(g),U=b(A),C=b(U),M=b(C),m=T(M);{var D=u=>{var q=Ze();x(u,q)};K(m,u=>{f()&&u(D)})}y(C);var I=T(C,2),i=b(I,!0);y(I),y(U);var a=T(U,2);y(A);var l=T(A,2),k=b(l),S=T(b(k),2);Ve(S,{get year(){return v()},get month(){return s()},get dayNumber(){return o()},initialData:{}}),y(k);var n=T(k,2),F=T(b(n),2);Ye(F,{get year(){return v()},get month(){return s()},get dayNumber(){return o()}}),y(n),y(l),y(g),z(()=>{O=ye(g,1,"day-detail-panel svelte-osrvy9",null,O,{today:f()}),W(M,`Day ${o()??""} - ${e(d)??""} `),W(i,e(p))}),ee("click",a,function(...u){w()?.apply(this,u)}),x(r,g),Y()}var aa=E('<div class="notebook-calendar-container svelte-tw9q0l"><!> <!></div>');function ba(r,t){Z(t,!1);const c=L();let d=N(t,"year",8),p=N(t,"month",8),v=N(t,"currentDay",8,null),s=L(null),o=L(!1);function f(C){_(s,C.detail.dayNumber),_(o,!0),setTimeout(()=>{const M=document.querySelector(".day-detail-panel");M&&M.scrollIntoView({behavior:"smooth",block:"nearest"})},100)}function w(){_(o,!1),_(s,null)}H(()=>(e(s),J(v())),()=>{_(c,e(s)===v())}),ue();var g=aa(),O=b(g);Be(O,{get year(){return d()},get month(){return p()},get currentDay(){return v()},get selectedDay(){return e(s)},$$events:{daySelected:f}});var A=T(O,2);{var U=C=>{ea(C,{get year(){return d()},get month(){return p()},get dayNumber(){return e(s)},get isToday(){return e(c)},onClose:w})};K(A,C=>{e(o)&&e(s)!==null&&C(U)})}y(g),x(r,g),Y()}export{ba as default};
