{"version":3,"file":"heatmap-DnvOPnk2.js","sources":["../../src/graphs/heatmap.js"],"sourcesContent":["/**\r\n * Heatmap Visualization - Monthly domain overview\r\n * Shows domains as rows, days as columns\r\n */\r\n\r\n/**\r\n * Renders a monthly heatmap visualization\r\n * @param {Array} data - Array of day records for the month\r\n * @param {HTMLElement} container - DOM element to render into\r\n * @param {Object} options - Configuration options\r\n */\r\nexport function renderHeatmap(data, container, options = {}) {\r\n  const {\r\n    cellSize = 24,\r\n    cellGap = 4,\r\n    labelWidth = 100,\r\n    year = new Date().getFullYear(),\r\n    month = new Date().getMonth() + 1,\r\n  } = options;\r\n\r\n  // Clear container\r\n  container.innerHTML = \"\";\r\n\r\n  if (!data || data.length === 0) {\r\n    container.innerHTML = '<p class=\"empty-state\">No data for this month</p>';\r\n    return;\r\n  }\r\n\r\n  // Get all unique domains from the data\r\n  const domainsSet = new Set();\r\n  data.forEach((day) => {\r\n    if (day.domains) {\r\n      Object.keys(day.domains).forEach((domain) => domainsSet.add(domain));\r\n    }\r\n  });\r\n  const domains = Array.from(domainsSet).sort();\r\n\r\n  // Get number of days in month\r\n  const daysInMonth = new Date(year, month, 0).getDate();\r\n\r\n  // Create a map of data by date\r\n  const dataByDate = new Map();\r\n  data.forEach((day) => {\r\n    const date = new Date(day.date + \"T00:00:00\");\r\n    const dayNum = date.getDate();\r\n    dataByDate.set(dayNum, day);\r\n  });\r\n\r\n  const width = labelWidth + (cellSize + cellGap) * daysInMonth + 20;\r\n  const height = 40 + (cellSize + cellGap) * domains.length + 10;\r\n\r\n  // Create SVG\r\n  const svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\r\n  svg.setAttribute(\"viewBox\", `0 0 ${width} ${height}`);\r\n  svg.style.width = \"100%\";\r\n  svg.style.height = \"auto\";\r\n\r\n  // Add border rectangle\r\n  const border = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");\r\n  border.setAttribute(\"x\", labelWidth - 5);\r\n  border.setAttribute(\"y\", 35);\r\n  border.setAttribute(\"width\", (cellSize + cellGap) * daysInMonth + 5);\r\n  border.setAttribute(\"height\", (cellSize + cellGap) * domains.length + 5);\r\n  border.setAttribute(\"fill\", \"none\");\r\n  border.setAttribute(\"stroke\", \"#edf2f7\");\r\n  border.setAttribute(\"stroke-width\", \"2\");\r\n  border.setAttribute(\"rx\", \"6\");\r\n  svg.appendChild(border);\r\n\r\n  // Add day numbers at top\r\n  for (let day = 1; day <= daysInMonth; day++) {\r\n    const dayLabel = document.createElementNS(\r\n      \"http://www.w3.org/2000/svg\",\r\n      \"text\"\r\n    );\r\n    dayLabel.setAttribute(\r\n      \"x\",\r\n      labelWidth + (day - 1) * (cellSize + cellGap) + cellSize / 2\r\n    );\r\n    dayLabel.setAttribute(\"y\", 30);\r\n    dayLabel.setAttribute(\"text-anchor\", \"middle\");\r\n    dayLabel.setAttribute(\"font-size\", \"10px\");\r\n    dayLabel.setAttribute(\"font-weight\", \"500\");\r\n    dayLabel.setAttribute(\"fill\", \"#718096\");\r\n    dayLabel.setAttribute(\r\n      \"font-family\",\r\n      \"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif\"\r\n    );\r\n    dayLabel.textContent = day;\r\n    svg.appendChild(dayLabel);\r\n  }\r\n\r\n  // Add domain labels on left and render cells\r\n  domains.forEach((domain, domainIdx) => {\r\n    // Domain label\r\n    const domainLabel = document.createElementNS(\r\n      \"http://www.w3.org/2000/svg\",\r\n      \"text\"\r\n    );\r\n    domainLabel.setAttribute(\"x\", labelWidth - 10);\r\n    domainLabel.setAttribute(\r\n      \"y\",\r\n      40 + domainIdx * (cellSize + cellGap) + cellSize / 2 + 5\r\n    );\r\n    domainLabel.setAttribute(\"text-anchor\", \"end\");\r\n    domainLabel.setAttribute(\"font-size\", \"11px\");\r\n    domainLabel.setAttribute(\"font-weight\", \"600\");\r\n    domainLabel.setAttribute(\"fill\", \"#4a5568\");\r\n    domainLabel.setAttribute(\r\n      \"font-family\",\r\n      \"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif\"\r\n    );\r\n    domainLabel.textContent = capitalizeFirst(domain);\r\n    svg.appendChild(domainLabel);\r\n\r\n    // Render cells for each day\r\n    for (let day = 1; day <= daysInMonth; day++) {\r\n      const x = labelWidth + (day - 1) * (cellSize + cellGap);\r\n      const y = 40 + domainIdx * (cellSize + cellGap);\r\n\r\n      const rect = document.createElementNS(\r\n        \"http://www.w3.org/2000/svg\",\r\n        \"rect\"\r\n      );\r\n      rect.setAttribute(\"x\", x);\r\n      rect.setAttribute(\"y\", y);\r\n      rect.setAttribute(\"width\", cellSize);\r\n      rect.setAttribute(\"height\", cellSize);\r\n      rect.setAttribute(\"rx\", 3);\r\n      rect.classList.add(\"heatmap-cell\");\r\n\r\n      // Get score for this domain on this day\r\n      const dayData = dataByDate.get(day);\r\n      const score =\r\n        (dayData && dayData.domains && dayData.domains[domain]) || 0;\r\n\r\n      const color = getHeatmapColor(score);\r\n      rect.setAttribute(\"fill\", color);\r\n\r\n      // Add subtle animation delay\r\n      rect.style.animationDelay = `${(domainIdx * daysInMonth + day) * 2}ms`;\r\n\r\n      // Tooltip\r\n      const title = document.createElementNS(\r\n        \"http://www.w3.org/2000/svg\",\r\n        \"title\"\r\n      );\r\n      const dateStr = `${year}-${String(month).padStart(2, \"0\")}-${String(\r\n        day\r\n      ).padStart(2, \"0\")}`;\r\n      title.textContent = `${capitalizeFirst(\r\n        domain\r\n      )} on ${dateStr}: ${score.toFixed(2)}`;\r\n      rect.appendChild(title);\r\n\r\n      svg.appendChild(rect);\r\n    }\r\n  });\r\n\r\n  container.appendChild(svg);\r\n}\r\n\r\n/**\r\n * Helper: Capitalize first letter\r\n */\r\nfunction capitalizeFirst(str) {\r\n  return str.charAt(0).toUpperCase() + str.slice(1);\r\n}\r\n\r\n/**\r\n * Gets refined heatmap color based on score\r\n * @param {number} score - Score value (0-1)\r\n * @returns {string} Hex color\r\n */\r\nfunction getHeatmapColor(score) {\r\n  if (score === 0) return \"#edf2f7\";\r\n\r\n  // Sophisticated blue-gray gradient - calm, focused, minimal\r\n  const colors = [\r\n    \"#edf2f7\", // 0-0.2 - very light\r\n    \"#cbd5e0\", // 0.2-0.4 - light\r\n    \"#a0aec0\", // 0.4-0.6 - medium\r\n    \"#718096\", // 0.6-0.8 - darker\r\n    \"#4a5568\", // 0.8-1.0 - darkest\r\n  ];\r\n\r\n  const index = Math.min(Math.floor(score * 5), 4);\r\n  return colors[index];\r\n}\r\n"],"names":["renderHeatmap","data","container","options","cellSize","cellGap","labelWidth","year","Date","getFullYear","month","getMonth","innerHTML","length","domainsSet","Set","forEach","day","domains","Object","keys","domain","add","Array","from","sort","daysInMonth","getDate","dataByDate","Map","dayNum","date","set","width","height","svg","document","createElementNS","setAttribute","style","border","appendChild","dayLabel","textContent","domainIdx","domainLabel","capitalizeFirst","x","y","rect","classList","dayData","get","score","color","getHeatmapColor","animationDelay","title","dateStr","String","padStart","toFixed","str","charAt","toUpperCase","slice","Math","min","floor"],"mappings":"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"}