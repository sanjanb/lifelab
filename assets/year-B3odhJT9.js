import{l as t}from"./storage-BXgAf6ik.js";import{r as n}from"./heatmap-DnvOPnk2.js";import{g as e}from"./schema-Cp9kWJcO.js";let a=(new Date).getFullYear(),s=[];function i(){s=[];for(let n=1;n<=12;n++){const e=t(a,n);s.push(...e)}!function(){const t=document.getElementById("year-heatmap");if(0===s.length)return void(t.innerHTML=`\n      <div class="empty-state">\n        <p>No data for ${a}.</p>\n      </div>\n    `);n(s,t,{year:a})}(),function(){const t=document.getElementById("year-stats");if(0===s.length)return void(t.innerHTML='<p class="empty-state">No data available</p>');const n=l();t.innerHTML=`\n    <div class="stat-card">\n      <div class="stat-value">${n.totalDays}</div>\n      <div class="stat-label">Days Tracked</div>\n    </div>\n    <div class="stat-card">\n      <div class="stat-value">${(100*n.coverage).toFixed(0)}%</div>\n      <div class="stat-label">Coverage</div>\n    </div>\n    <div class="stat-card">\n      <div class="stat-value">${n.avgScore.toFixed(2)}</div>\n      <div class="stat-label">Average Score</div>\n    </div>\n    <div class="stat-card">\n      <div class="stat-value">${n.bestMonth}</div>\n      <div class="stat-label">Best Month</div>\n    </div>\n    <div class="stat-card">\n      <div class="stat-value">${n.longestStreak}</div>\n      <div class="stat-label">Longest Streak</div>\n    </div>\n    <div class="stat-card">\n      <div class="stat-value">${n.topDomain}</div>\n      <div class="stat-label">Top Domain</div>\n    </div>\n  `}(),function(){const t=document.getElementById("monthly-comparison"),n=[],e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];for(let i=1;i<=12;i++){const t=s.filter(t=>new Date(t.date).getMonth()+1===i);if(t.length>0){const a=t.map(t=>r(t)).filter(t=>null!==t),s=a.reduce((t,n)=>t+n,0)/a.length;n.push({month:e[i-1],avg:s,count:t.length})}}if(0===n.length)return void(t.innerHTML='<p class="empty-state">No monthly data</p>');const a=Math.max(...n.map(t=>t.avg));t.innerHTML=`\n    <div class="monthly-bars">\n      ${n.map(t=>`\n        <div class="month-bar">\n          <div class="bar-fill" style="height: ${t.avg/a*100}%"></div>\n          <div class="bar-label">${t.month}</div>\n          <div class="bar-value">${t.avg.toFixed(2)}</div>\n        </div>\n      `).join("")}\n    </div>\n  `}(),function(){const t=document.getElementById("domain-trends"),n=e(s);if(0===n.size)return void(t.innerHTML='<p class="empty-state">No domain data</p>');const a=[];n.forEach(t=>{const n=s.filter(n=>n.domains&&void 0!==n.domains[t]).map(n=>n.domains[t]),e=n.reduce((t,n)=>t+n,0)/n.length,i=function(t,n){const e=t.filter(t=>t.domains&&void 0!==t.domains[n]);if(e.length<10)return 0;const a=e.slice(0,Math.floor(e.length/2)),s=e.slice(Math.floor(e.length/2)),i=a.reduce((t,e)=>t+e.domains[n],0)/a.length,o=s.reduce((t,e)=>t+e.domains[n],0)/s.length;return o-i}(s,t);a.push({domain:t,avg:e,trend:i,count:n.length})}),a.sort((t,n)=>n.avg-t.avg),t.innerHTML=`\n    <div class="domain-trends-list">\n      ${a.map(t=>`\n        <div class="domain-trend-item">\n          <div class="domain-name">${c(t.domain)}</div>\n          <div class="domain-bar">\n            <div class="domain-bar-fill" style="width: ${100*t.avg}%"></div>\n          </div>\n          <div class="domain-avg">${t.avg.toFixed(2)}</div>\n          <div class="domain-trend ${t.trend>0?"positive":t.trend<0?"negative":"neutral"}">\n            ${t.trend>0?"↗":t.trend<0?"↘":"→"} ${Math.abs(100*t.trend).toFixed(1)}%\n          </div>\n        </div>\n      `).join("")}\n    </div>\n  `}(),function(){const t=document.getElementById("year-insights");if(0===s.length)return void(t.innerHTML="<li>No data to analyze</li>");const n=function(){const t=[],n=l();n.coverage>.9?t.push(`Excellent consistency: tracked ${(100*n.coverage).toFixed(0)}% of days`):n.coverage<.5&&t.push(`Low tracking coverage: only ${(100*n.coverage).toFixed(0)}% of days recorded`);n.avgScore>.7?t.push(`Strong year overall with ${n.avgScore.toFixed(2)} average score`):n.avgScore<.4&&t.push(`Challenging year with ${n.avgScore.toFixed(2)} average score`);n.longestStreak>30&&t.push(`Impressive ${n.longestStreak}-day tracking streak`);const e=d(1),a=d(4);if(null!==e&&null!==a){const n=a-e;n>.15?t.push(`Strong finish: Q4 outperformed Q1 by ${(100*n).toFixed(0)}%`):n<-.15&&t.push(`Started strong: Q1 outperformed Q4 by ${(100*Math.abs(n)).toFixed(0)}%`)}return t.length>0?t:["Gathering yearly patterns..."]}();t.innerHTML=n.map(t=>`<li>${t}</li>`).join("")}()}function o(){document.getElementById("current-year-display").textContent=a}function l(){const t=s.length;var n;const i=t/((n=a)%4==0&&n%100!=0||n%400==0?366:365),o=s.map(t=>r(t)).filter(t=>null!==t),l=o.length>0?o.reduce((t,n)=>t+n,0)/o.length:0,d=[];for(let e=1;e<=12;e++){const t=s.filter(t=>new Date(t.date).getMonth()+1===e);if(t.length>0){const n=t.map(t=>r(t)).filter(t=>null!==t),a=n.reduce((t,n)=>t+n,0)/n.length;d.push({month:e,avg:a})}}const v=d.sort((t,n)=>n.avg-t.avg)[0],g=v?new Date(a,v.month-1).toLocaleDateString("en-US",{month:"short"}):"—",u=function(t){if(0===t.length)return 0;const n=t.map(t=>new Date(t.date)).sort((t,n)=>t-n);let e=1,a=1;for(let s=1;s<n.length;s++){1===(n[s]-n[s-1])/864e5?(a++,e=Math.max(e,a)):a=1}return e}(s),m=e(s);let h="—",f=0;return m.forEach(t=>{const n=s.filter(n=>n.domains&&void 0!==n.domains[t]).map(n=>n.domains[t]),e=n.reduce((t,n)=>t+n,0)/n.length;e>f&&(f=e,h=c(t))}),{totalDays:t,coverage:i,avgScore:l,bestMonth:g,longestStreak:u,topDomain:h}}function r(t){if(!t||!t.domains)return null;const n=Object.values(t.domains);return 0===n.length?null:n.reduce((t,n)=>t+n,0)/n.length}function d(t){const n=1===t?[1,2,3]:2===t?[4,5,6]:3===t?[7,8,9]:[10,11,12],e=s.filter(t=>n.includes(new Date(t.date).getMonth()+1));if(0===e.length)return null;const a=e.map(t=>r(t)).filter(t=>null!==t);return a.reduce((t,n)=>t+n,0)/a.length}function c(t){return t.charAt(0).toUpperCase()+t.slice(1)}!async function(){o(),i(),document.getElementById("prev-year").addEventListener("click",()=>{a--,o(),i()}),document.getElementById("next-year").addEventListener("click",()=>{a++,o(),i()})}();
//# sourceMappingURL=year-B3odhJT9.js.map
