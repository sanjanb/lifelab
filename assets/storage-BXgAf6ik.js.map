{"version":3,"file":"storage-BXgAf6ik.js","sources":["../../src/data/storage.js"],"sourcesContent":["/**\r\n * LocalStorage Data Persistence\r\n * Simple local storage for data that persists across sessions\r\n */\r\n\r\nconst STORAGE_KEY = \"lifelab_data\";\r\nconst SETTINGS_KEY = \"lifelab_settings\";\r\n\r\n/**\r\n * Saves data to localStorage\r\n * @param {Object} data - Data object mapping months to day arrays\r\n */\r\nexport function saveToLocalStorage(data) {\r\n  try {\r\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));\r\n    return true;\r\n  } catch (error) {\r\n    console.error(\"Failed to save to localStorage:\", error);\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Loads all data from localStorage\r\n * @returns {Object} Data object or empty object\r\n */\r\nexport function loadFromLocalStorage() {\r\n  try {\r\n    const data = localStorage.getItem(STORAGE_KEY);\r\n    return data ? JSON.parse(data) : {};\r\n  } catch (error) {\r\n    console.error(\"Failed to load from localStorage:\", error);\r\n    return {};\r\n  }\r\n}\r\n\r\n/**\r\n * Saves data for a specific month\r\n * @param {number} year - Year\r\n * @param {number} month - Month (1-12)\r\n * @param {Array} monthData - Array of day records\r\n */\r\nexport function saveMonth(year, month, monthData) {\r\n  const allData = loadFromLocalStorage();\r\n  const key = `${year}-${String(month).padStart(2, \"0\")}`;\r\n  allData[key] = monthData;\r\n  return saveToLocalStorage(allData);\r\n}\r\n\r\n/**\r\n * Loads data for a specific month\r\n * @param {number} year - Year\r\n * @param {number} month - Month (1-12)\r\n * @returns {Array} Array of day records\r\n */\r\nexport function loadMonth(year, month) {\r\n  const allData = loadFromLocalStorage();\r\n  const key = `${year}-${String(month).padStart(2, \"0\")}`;\r\n  return allData[key] || [];\r\n}\r\n\r\n/**\r\n * Adds or updates a single day entry\r\n * @param {Object} dayData - Day record\r\n * @returns {boolean} Success status\r\n */\r\nexport function saveDayEntry(dayData) {\r\n  const date = new Date(dayData.date);\r\n  const year = date.getFullYear();\r\n  const month = date.getMonth() + 1;\r\n\r\n  let monthData = loadMonth(year, month);\r\n\r\n  // Remove existing entry for this date\r\n  monthData = monthData.filter((d) => d.date !== dayData.date);\r\n\r\n  // Add new entry\r\n  monthData.push(dayData);\r\n\r\n  // Sort by date\r\n  monthData.sort((a, b) => a.date.localeCompare(b.date));\r\n\r\n  return saveMonth(year, month, monthData);\r\n}\r\n\r\n/**\r\n * Deletes a day entry\r\n * @param {string} date - ISO date string\r\n * @returns {boolean} Success status\r\n */\r\nexport function deleteDayEntry(date) {\r\n  const dateObj = new Date(date);\r\n  const year = dateObj.getFullYear();\r\n  const month = dateObj.getMonth() + 1;\r\n\r\n  let monthData = loadMonth(year, month);\r\n  monthData = monthData.filter((d) => d.date !== date);\r\n\r\n  return saveMonth(year, month, monthData);\r\n}\r\n\r\n/**\r\n * Gets all months that have data\r\n * @returns {Array} Array of {year, month} objects\r\n */\r\nexport function getAvailableMonths() {\r\n  const allData = loadFromLocalStorage();\r\n  return Object.keys(allData)\r\n    .map((key) => {\r\n      const [year, month] = key.split(\"-\");\r\n      return {\r\n        year: parseInt(year),\r\n        month: parseInt(month),\r\n        key,\r\n      };\r\n    })\r\n    .sort((a, b) => a.key.localeCompare(b.key));\r\n}\r\n\r\n/**\r\n * Saves settings\r\n * @param {Object} settings - Settings object\r\n */\r\nexport function saveSettings(settings) {\r\n  try {\r\n    localStorage.setItem(SETTINGS_KEY, JSON.stringify(settings));\r\n    return true;\r\n  } catch (error) {\r\n    console.error(\"Failed to save settings:\", error);\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Loads settings\r\n * @returns {Object} Settings object\r\n */\r\nexport function loadSettings() {\r\n  try {\r\n    const settings = localStorage.getItem(SETTINGS_KEY);\r\n    return settings ? JSON.parse(settings) : getDefaultSettings();\r\n  } catch (error) {\r\n    console.error(\"Failed to load settings:\", error);\r\n    return getDefaultSettings();\r\n  }\r\n}\r\n\r\n/**\r\n * Gets default settings\r\n */\r\nfunction getDefaultSettings() {\r\n  return {\r\n    domains: {\r\n      health: true,\r\n      skills: true,\r\n      finance: true,\r\n      academics: true,\r\n    },\r\n    theme: \"light\",\r\n    firstDayOfWeek: 1, // Monday\r\n  };\r\n}\r\n\r\n/**\r\n * Clears all data (with confirmation)\r\n * @returns {boolean} Success status\r\n */\r\nexport function clearAllData() {\r\n  try {\r\n    localStorage.removeItem(STORAGE_KEY);\r\n    return true;\r\n  } catch (error) {\r\n    console.error(\"Failed to clear data:\", error);\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Merges imported data with existing data\r\n * @param {Array} importedData - Array of day records to merge\r\n */\r\nexport function mergeImportedData(importedData) {\r\n  const grouped = {};\r\n\r\n  // Group imported data by month\r\n  importedData.forEach((day) => {\r\n    const date = new Date(day.date);\r\n    const year = date.getFullYear();\r\n    const month = date.getMonth() + 1;\r\n    const key = `${year}-${String(month).padStart(2, \"0\")}`;\r\n\r\n    if (!grouped[key]) {\r\n      grouped[key] = [];\r\n    }\r\n    grouped[key].push(day);\r\n  });\r\n\r\n  // Merge with existing data\r\n  Object.entries(grouped).forEach(([key, days]) => {\r\n    const [year, month] = key.split(\"-\");\r\n    const existingData = loadMonth(parseInt(year), parseInt(month));\r\n\r\n    // Create a map of existing dates\r\n    const dateMap = new Map(existingData.map((d) => [d.date, d]));\r\n\r\n    // Add/update with imported data\r\n    days.forEach((day) => {\r\n      dateMap.set(day.date, day);\r\n    });\r\n\r\n    // Convert back to array and sort\r\n    const mergedData = Array.from(dateMap.values()).sort((a, b) =>\r\n      a.date.localeCompare(b.date)\r\n    );\r\n\r\n    saveMonth(parseInt(year), parseInt(month), mergedData);\r\n  });\r\n}\r\n"],"names":["STORAGE_KEY","SETTINGS_KEY","loadFromLocalStorage","data","localStorage","getItem","JSON","parse","error","console","saveMonth","year","month","monthData","allData","String","padStart","setItem","stringify","saveToLocalStorage","loadMonth","saveDayEntry","dayData","date","Date","getFullYear","getMonth","filter","d","push","sort","a","b","localeCompare","deleteDayEntry","dateObj","saveSettings","settings","loadSettings","domains","health","skills","finance","academics","theme","firstDayOfWeek","clearAllData","removeItem","mergeImportedData","importedData","grouped","forEach","day","key","Object","entries","days","split","existingData","parseInt","dateMap","Map","map","set","mergedData","Array","from","values"],"mappings":"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"}