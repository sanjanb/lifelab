import{f as t,l as e}from"./storage-BXgAf6ik.js";import{r as n}from"./heatmap-DnvOPnk2.js";function i(t,e,n={}){const{width:i=800,height:r=300,marginTop:o=20,marginRight:a=20,marginBottom:s=40,marginLeft:c=50}=n;e.innerHTML="";const l=i-c-a,h=r-o-s,d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttribute("viewBox",`0 0 ${i} ${r}`),d.classList.add("svg-graph");const g=document.createElementNS("http://www.w3.org/2000/svg","g");g.setAttribute("transform",`translate(${c}, ${o})`);const u=Math.max(...t.map(t=>new Date(t.date).getDate())),p=document.createElementNS("http://www.w3.org/2000/svg","line");p.setAttribute("x1",0),p.setAttribute("y1",h),p.setAttribute("x2",l),p.setAttribute("y2",h),p.classList.add("axis-line"),g.appendChild(p);const m=document.createElementNS("http://www.w3.org/2000/svg","line");m.setAttribute("x1",0),m.setAttribute("y1",0),m.setAttribute("x2",0),m.setAttribute("y2",h),m.classList.add("axis-line"),g.appendChild(m);for(let v=0;v<=4;v++){const t=.25*v,e=h-t*h,n=document.createElementNS("http://www.w3.org/2000/svg","text");n.setAttribute("x",-10),n.setAttribute("y",e+4),n.setAttribute("text-anchor","end"),n.textContent=t.toFixed(2),g.appendChild(n);const i=document.createElementNS("http://www.w3.org/2000/svg","line");i.setAttribute("x1",0),i.setAttribute("y1",e),i.setAttribute("x2",l),i.setAttribute("y2",e),i.setAttribute("stroke","#e0e0e0"),i.setAttribute("stroke-dasharray","2,2"),g.appendChild(i)}const f=t.map(t=>{const e=new Date(t.date).getDate(),n=function(t){if(!t.domains)return 0;const e=Object.values(t.domains);return 0===e.length?0:e.reduce((t,e)=>t+e,0)/e.length}(t);return{x:e/u*l,y:h-n*h,day:e,score:n}});if(f.sort((t,e)=>t.day-e.day),f.length>0){const t=f.map((t,e)=>`${0===e?"M":"L"} ${t.x} ${t.y}`).join(" "),e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d",t),e.classList.add("data-line"),g.appendChild(e),f.forEach(t=>{const e=document.createElementNS("http://www.w3.org/2000/svg","circle");e.setAttribute("cx",t.x),e.setAttribute("cy",t.y),e.setAttribute("r",3),e.classList.add("data-point");const n=document.createElementNS("http://www.w3.org/2000/svg","title");n.textContent=`Day ${t.day}: ${t.score.toFixed(2)}`,e.appendChild(n),g.appendChild(e)})}const y=document.createElementNS("http://www.w3.org/2000/svg","text");y.setAttribute("x",l/2),y.setAttribute("y",h+30),y.setAttribute("text-anchor","middle"),y.textContent="Day of Month",g.appendChild(y);const w=document.createElementNS("http://www.w3.org/2000/svg","text");w.setAttribute("x",-h/2),w.setAttribute("y",-35),w.setAttribute("text-anchor","middle"),w.setAttribute("transform",`rotate(-90, -${h/2}, -35)`),w.textContent="Daily Score",g.appendChild(w),d.appendChild(g),e.appendChild(d)}function r(t){if(!t||0===t.length)return[{type:"info",icon:"info",message:"No data available for analysis",highlight:null}];const e=[],n=function(t){const e=t.map(t=>o(t)).filter(t=>null!==t);if(e.length<5)return null;const n=e.slice(0,Math.floor(e.length/2)),i=e.slice(Math.floor(e.length/2)),r=a(n),s=a(i)-r;return Math.abs(s)<.05?{type:"neutral",icon:"trend",message:"Scores remained stable throughout the month",highlight:null}:s>0?{type:"positive",icon:"up",message:"Upward trend detected",highlight:`+${(100*s).toFixed(1)}%`}:{type:"warning",icon:"down",message:"Scores dipped in second half",highlight:`-${Math.abs(100*s).toFixed(1)}%`}}(t);n&&e.push(n);const i=function(t){const e=t.map((t,e)=>({day:e+1,score:o(t)})).filter(t=>null!==t.score);if(e.length<10)return null;const n=5;let i=1,r=0;for(let o=0;o<=e.length-n;o++){const t=e.slice(o,o+n),s=a(t.map(t=>t.score));s<i&&(i=s,r=t[Math.floor(n/2)].day)}if(i<.5)return{type:"warning",icon:"energy",message:"Energy dips detected",highlight:`Day ${r}`};return null}(t);i&&e.push(i);const r=function(t){const e=function(t){const e=new Set;return t.forEach(t=>{t.domains&&Object.keys(t.domains).forEach(t=>e.add(t))}),Array.from(e)}(t);if(e.length<2)return null;const n={};e.forEach(e=>{n[e]=t.filter(t=>t.domains&&void 0!==t.domains[e]).map(t=>t.domains[e])});let i=null,r=1;for(const[o,s]of Object.entries(n)){if(0===s.length)continue;const t=a(s);t<r&&(r=t,i=o)}if(i&&r<.4)return{type:"alert",icon:"alert",message:`${s(i)} needs attention`,highlight:`${(100*r).toFixed(0)}%`};return null}(t);r&&e.push(r);const c=function(t){const e=30,n=t.length/e*100;if(n<50)return{type:"warning",icon:"calendar",message:"Low tracking coverage",highlight:`${n.toFixed(0)}% recorded`};if(n>90)return{type:"positive",icon:"check",message:"Excellent tracking consistency",highlight:`${n.toFixed(0)}%`};return null}(t);c&&e.push(c);const l=function(t){const e=[],n=[];if(t.forEach(t=>{const i=new Date(t.date).getDay(),r=o(t);null!==r&&(0===i||6===i?n.push(r):e.push(r))}),e.length<3||n.length<2)return null;const i=a(e),r=a(n)-i;if(Math.abs(r)>.15)return r>0?{type:"info",icon:"calendar",message:"Weekend scores consistently higher",highlight:"+"+(100*r).toFixed(0)+"%"}:{type:"info",icon:"calendar",message:"Weekday performance exceeds weekends",highlight:"+"+(100*Math.abs(r)).toFixed(0)+"%"};return null}(t);return l&&e.push(l),e.length>0?e:[{type:"info",icon:"info",message:"Gathering patterns...",highlight:null}]}function o(t){if(!t||!t.domains)return null;const e=Object.values(t.domains);return 0===e.length?null:e.reduce((t,e)=>t+e,0)/e.length}function a(t){return 0===t.length?0:t.reduce((t,e)=>t+e,0)/t.length}function s(t){return t.charAt(0).toUpperCase()+t.slice(1)}async function c(){const e=new Date,n=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0");await async function(e,n){try{const i=await fetch(`/data/months/${e}-${n}.json`);if(!i.ok)return console.warn(`No JSON file found for ${e}-${n}`),!1;const r=await i.json();return Array.isArray(r)?(t(parseInt(e),parseInt(n),r),console.log(`Migrated ${r.length} entries for ${e}-${n}`),!0):(console.error(`Invalid format for ${e}-${n}`),!1)}catch(i){return console.error(`Failed to migrate ${e}-${n}:`,i),!1}}(n,i)}function l(t){const e={up:'<path d="M5 15l7-7 7 7"/><path d="M12 8v14"/>',down:'<path d="M19 9l-7 7-7-7"/><path d="M12 16V2"/>',trend:'<path d="M23 6l-9.5 9.5-5-5L1 18"/><path d="M17 6h6v6"/>',energy:'<circle cx="12" cy="12" r="10"/><path d="M12 2v4m0 12v4M2 12h4m12 0h4"/>',alert:'<circle cx="12" cy="12" r="10"/><path d="M12 8v4m0 4h.01"/>',calendar:'<rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/>',check:'<path d="M20 6L9 17l-5-5"/>',info:'<circle cx="12" cy="12" r="10"/><path d="M12 16v-4m0-4h.01"/>'},n=e[t.icon]||e.info;return`\n    <li data-type="${t.type}">\n      <div class="insight-icon">\n        <svg viewBox="0 0 24 24">${n}</svg>\n      </div>\n      <div class="insight-content">\n        <div class="insight-message">${t.message}</div>\n        ${t.highlight?`<div class="insight-highlight">${t.highlight}</div>`:""}\n      </div>\n    </li>\n  `}!async function(){try{["line-graph","heatmap","insights-list"].forEach(t=>{const e=document.getElementById(t);e&&(e.innerHTML='<div class="loading">Loading data</div>')});const t=new Date;let o=e(t.getFullYear(),t.getMonth()+1);if(0===o.length&&(await c(),o=e(t.getFullYear(),t.getMonth()+1)),0===o.length)return void function(){const t=document.getElementById("line-graph");t&&(t.innerHTML='\n      <div class="empty-state">\n        <p>No data available for the current month.</p>\n        <p>Go to <a href="./notebook.html">Notebook</a> to start tracking!</p>\n      </div>\n    ');const e=document.getElementById("heatmap");e&&(e.innerHTML="");const n=document.getElementById("insights-list");n&&(n.innerHTML=l({type:"info",icon:"info",message:"Start tracking to generate insights",highlight:null}))}();!function(t){const e=new Date,o=document.getElementById("line-graph");o&&i(t,o);const a=document.getElementById("heatmap");a&&n(t,a,{year:e.getFullYear(),month:e.getMonth()+1});const s=r(t),c=document.getElementById("insights-list");c&&(c.innerHTML=s.map(t=>l(t)).join(""))}(o)}catch(t){console.error("Failed to initialize:",t),function(t){const e=document.getElementById("line-graph");e&&(e.innerHTML=`\n      <div class="empty-state">\n        <p>Error: ${t}</p>\n      </div>\n    `)}(t.message)}}();
//# sourceMappingURL=main-kWzwK3e7.js.map
