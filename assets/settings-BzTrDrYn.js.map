{"version":3,"file":"settings-BzTrDrYn.js","sources":["../../src/pages/settings.js"],"sourcesContent":["/**\r\n * Settings Page\r\n * Domain configuration and preferences\r\n */\r\n\r\nimport \"../styles/base.css\";\r\nimport \"../styles/layout.css\";\r\nimport \"../styles/components.css\";\r\n\r\nimport {\r\n  loadSettings,\r\n  saveSettings,\r\n  clearAllData,\r\n  loadFromLocalStorage,\r\n} from \"../data/storage.js\";\r\nimport { renderImportExportUI, exportFullBackup } from \"../data/export.js\";\r\nimport { mergeImportedData } from \"../data/storage.js\";\r\n\r\nlet currentSettings = {};\r\n\r\n/**\r\n * Initialize settings page\r\n */\r\nasync function init() {\r\n  currentSettings = loadSettings();\r\n  renderDomainConfig();\r\n  renderDataStats();\r\n  renderExportImport();\r\n  renderDangerZone();\r\n  renderPreferences();\r\n}\r\n\r\n/**\r\n * Render domain configuration\r\n */\r\nfunction renderDomainConfig() {\r\n  const container = document.getElementById(\"domain-config\");\r\n\r\n  container.innerHTML = `\r\n    <div class=\"domain-list\">\r\n      ${Object.entries(currentSettings.domains)\r\n        .map(\r\n          ([domain, enabled]) => `\r\n        <label class=\"domain-item\">\r\n          <input \r\n            type=\"checkbox\" \r\n            class=\"domain-checkbox\" \r\n            data-domain=\"${domain}\" \r\n            ${enabled ? \"checked\" : \"\"}\r\n          />\r\n          <span>${capitalizeFirst(domain)}</span>\r\n        </label>\r\n      `\r\n        )\r\n        .join(\"\")}\r\n    </div>\r\n    \r\n    <div class=\"add-domain\">\r\n      <input \r\n        type=\"text\" \r\n        id=\"new-domain-name\" \r\n        placeholder=\"Add new domain\" \r\n      />\r\n      <button class=\"btn-secondary\" id=\"add-domain-btn\">Add</button>\r\n    </div>\r\n    \r\n    <button class=\"btn-primary\" id=\"save-domains\">Save Changes</button>\r\n  `;\r\n\r\n  // Attach event listeners\r\n  container\r\n    .querySelector(\"#add-domain-btn\")\r\n    .addEventListener(\"click\", addNewDomain);\r\n  container\r\n    .querySelector(\"#save-domains\")\r\n    .addEventListener(\"click\", saveDomainSettings);\r\n}\r\n\r\n/**\r\n * Add a new domain\r\n */\r\nfunction addNewDomain() {\r\n  const input = document.getElementById(\"new-domain-name\");\r\n  const domainName = input.value.trim().toLowerCase();\r\n\r\n  if (!domainName) {\r\n    alert(\"Please enter a domain name\");\r\n    return;\r\n  }\r\n\r\n  if (currentSettings.domains[domainName] !== undefined) {\r\n    alert(\"This domain already exists\");\r\n    return;\r\n  }\r\n\r\n  currentSettings.domains[domainName] = true;\r\n  input.value = \"\";\r\n  renderDomainConfig();\r\n}\r\n\r\n/**\r\n * Save domain settings\r\n */\r\nfunction saveDomainSettings() {\r\n  const checkboxes = document.querySelectorAll(\".domain-checkbox\");\r\n  checkboxes.forEach((cb) => {\r\n    const domain = cb.dataset.domain;\r\n    currentSettings.domains[domain] = cb.checked;\r\n  });\r\n\r\n  if (saveSettings(currentSettings)) {\r\n    alert(\"Domain settings saved!\");\r\n  } else {\r\n    alert(\"Failed to save settings\");\r\n  }\r\n}\r\n\r\n/**\r\n * Render data stats section\r\n */\r\nfunction renderDataStats() {\r\n  const container = document.getElementById(\"data-stats\");\r\n\r\n  const allData = loadFromLocalStorage();\r\n  const dataSize = JSON.stringify(allData).length;\r\n  const entriesCount = Object.values(allData).reduce(\r\n    (sum, month) => sum + month.length,\r\n    0\r\n  );\r\n\r\n  container.innerHTML = `\r\n    <div class=\"bento-stats\">\r\n      <div class=\"bento-stat\">\r\n        <div class=\"stat-value\">${entriesCount}</div>\r\n        <div class=\"stat-label\">entries</div>\r\n      </div>\r\n      <div class=\"bento-stat\">\r\n        <div class=\"stat-value\">${(dataSize / 1024).toFixed(1)}</div>\r\n        <div class=\"stat-label\">KB</div>\r\n      </div>\r\n    </div>\r\n  `;\r\n}\r\n\r\n/**\r\n * Render export/import section\r\n */\r\nfunction renderExportImport() {\r\n  const container = document.getElementById(\"export-import\");\r\n\r\n  const allData = loadFromLocalStorage();\r\n\r\n  container.innerHTML = `\r\n    <div id=\"import-export-ui\"></div>\r\n    <button class=\"btn-secondary\" id=\"full-backup\">Full Backup</button>\r\n  `;\r\n\r\n  // Render import/export UI\r\n  renderImportExportUI(\r\n    container.querySelector(\"#import-export-ui\"),\r\n    Object.values(allData).flat(),\r\n    (importedData) => {\r\n      mergeImportedData(importedData);\r\n      renderDataStats();\r\n    }\r\n  );\r\n\r\n  // Full backup\r\n  container.querySelector(\"#full-backup\").addEventListener(\"click\", () => {\r\n    exportFullBackup(allData);\r\n  });\r\n}\r\n\r\n/**\r\n * Render danger zone section\r\n */\r\nfunction renderDangerZone() {\r\n  const container = document.getElementById(\"danger-zone\");\r\n\r\n  container.innerHTML = `\r\n    <p class=\"danger-warning\">This will permanently delete all your data. This cannot be undone.</p>\r\n    <button class=\"btn-danger\" id=\"clear-all-data\">Clear All Data</button>\r\n  `;\r\n\r\n  // Clear all data\r\n  container.querySelector(\"#clear-all-data\").addEventListener(\"click\", () => {\r\n    const confirmed = confirm(\r\n      \"Are you ABSOLUTELY SURE you want to delete all data?\\n\\n\" +\r\n        \"This action cannot be undone!\\n\\n\" +\r\n        \"Make sure you have exported your data first.\"\r\n    );\r\n\r\n    if (!confirmed) return;\r\n\r\n    const doubleCheck = prompt('Type \"DELETE ALL\" to confirm:');\r\n    if (doubleCheck === \"DELETE ALL\") {\r\n      if (clearAllData()) {\r\n        alert(\"All data has been cleared\");\r\n        renderDataStats();\r\n      } else {\r\n        alert(\"Failed to clear data\");\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * Render preferences section\r\n */\r\nfunction renderPreferences() {\r\n  const container = document.getElementById(\"preferences\");\r\n\r\n  container.innerHTML = `\r\n    <div class=\"preference-list\">\r\n      <div class=\"preference-item\">\r\n        <label>First Day of Week</label>\r\n        <select id=\"first-day-select\">\r\n          <option value=\"0\" ${\r\n            currentSettings.firstDayOfWeek === 0 ? \"selected\" : \"\"\r\n          }>Sunday</option>\r\n          <option value=\"1\" ${\r\n            currentSettings.firstDayOfWeek === 1 ? \"selected\" : \"\"\r\n          }>Monday</option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n    \r\n    <button class=\"btn-primary\" id=\"save-preferences\">Save Changes</button>\r\n  `;\r\n\r\n  container.querySelector(\"#save-preferences\").addEventListener(\"click\", () => {\r\n    currentSettings.firstDayOfWeek = parseInt(\r\n      document.getElementById(\"first-day-select\").value\r\n    );\r\n\r\n    if (saveSettings(currentSettings)) {\r\n      alert(\"Preferences saved!\");\r\n    } else {\r\n      alert(\"Failed to save preferences\");\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * Helper: Capitalize first letter\r\n */\r\nfunction capitalizeFirst(str) {\r\n  return str.charAt(0).toUpperCase() + str.slice(1);\r\n}\r\n\r\n// Initialize\r\ninit();\r\n"],"names":["currentSettings","renderDomainConfig","container","document","getElementById","innerHTML","Object","entries","domains","map","domain","enabled","str","charAt","toUpperCase","slice","join","querySelector","addEventListener","addNewDomain","saveDomainSettings","input","domainName","value","trim","toLowerCase","alert","querySelectorAll","forEach","cb","dataset","checked","saveSettings","renderDataStats","allData","loadFromLocalStorage","dataSize","JSON","stringify","length","entriesCount","values","reduce","sum","month","toFixed","async","loadSettings","renderImportExportUI","flat","importedData","mergeImportedData","exportFullBackup","renderExportImport","confirm","prompt","clearAllData","renderDangerZone","firstDayOfWeek","parseInt","renderPreferences","init"],"mappings":"sHAkBA,IAAIA,EAAkB,CAAA,EAiBtB,SAASC,IACP,MAAMC,EAAYC,SAASC,eAAe,iBAE1CF,EAAUG,UAAY,0CAEhBC,OAAOC,QAAQP,EAAgBQ,SAC9BC,IACC,EAAEC,EAAQC,MAAa,gKAKND,oBACbC,EAAU,UAAY,qCAsMXC,EApMSF,EAqMzBE,EAAIC,OAAO,GAAGC,cAAgBF,EAAIG,MAAM,sCADjD,IAAyBH,IAhMhBI,KAAK,gVAgBZd,EACGe,cAAc,mBACdC,iBAAiB,QAASC,GAC7BjB,EACGe,cAAc,iBACdC,iBAAiB,QAASE,EAC/B,CAKA,SAASD,IACP,MAAME,EAAQlB,SAASC,eAAe,mBAChCkB,EAAaD,EAAME,MAAMC,OAAOC,cAEjCH,OAKuC,IAAxCtB,EAAgBQ,QAAQc,IAK5BtB,EAAgBQ,QAAQc,IAAc,EACtCD,EAAME,MAAQ,GACdtB,KANEyB,MAAM,8BALNA,MAAM,6BAYV,CAKA,SAASN,IACYjB,SAASwB,iBAAiB,oBAClCC,QAASC,IAClB,MAAMnB,EAASmB,EAAGC,QAAQpB,OAC1BV,EAAgBQ,QAAQE,GAAUmB,EAAGE,UAGnCC,EAAahC,GACf0B,MAAM,0BAENA,MAAM,0BAEV,CAKA,SAASO,IACP,MAAM/B,EAAYC,SAASC,eAAe,cAEpC8B,EAAUC,IACVC,EAAWC,KAAKC,UAAUJ,GAASK,OACnCC,EAAelC,OAAOmC,OAAOP,GAASQ,OAC1C,CAACC,EAAKC,IAAUD,EAAMC,EAAML,OAC5B,GAGFrC,EAAUG,UAAY,oGAGUmC,0IAICJ,EAAW,MAAMS,QAAQ,kFAK5D,EAvHAC,iBACE9C,EAAkB+C,IAClB9C,IACAgC,IAyHF,WACE,MAAM/B,EAAYC,SAASC,eAAe,iBAEpC8B,EAAUC,IAEhBjC,EAAUG,UAAY,uHAMtB2C,EACE9C,EAAUe,cAAc,qBACxBX,OAAOmC,OAAOP,GAASe,OACtBC,IACCC,EAAkBD,GAClBjB,MAKJ/B,EAAUe,cAAc,gBAAgBC,iBAAiB,QAAS,KAChEkC,EAAiBlB,IAErB,CAhJEmB,GAqJF,WACE,MAAMnD,EAAYC,SAASC,eAAe,eAE1CF,EAAUG,UAAY,yLAMtBH,EAAUe,cAAc,mBAAmBC,iBAAiB,QAAS,KAOnE,IANkBoC,QAChB,yIAKc,OAGI,eADAC,OAAO,mCAErBC,KACF9B,MAAM,6BACNO,KAEAP,MAAM,0BAId,CAhLE+B,GAqLF,WACE,MAAMvD,EAAYC,SAASC,eAAe,eAE1CF,EAAUG,UAAY,2LAMuB,IAAnCL,EAAgB0D,eAAuB,WAAa,mDAGjB,IAAnC1D,EAAgB0D,eAAuB,WAAa,yJAS9DxD,EAAUe,cAAc,qBAAqBC,iBAAiB,QAAS,KACrElB,EAAgB0D,eAAiBC,SAC/BxD,SAASC,eAAe,oBAAoBmB,OAG1CS,EAAahC,GACf0B,MAAM,sBAENA,MAAM,+BAGZ,CApNEkC,EACF,CA6NAC"}